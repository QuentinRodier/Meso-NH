DIR_OBJ = ./$(ARCH)

VPATH = src:$(DIR_OBJ)
DIR_CONF:=$(shell pwd|sed -e 's/lib\/.*/conf/')

include $(DIR_CONF)/config.$(ARCH)
include Rules.$(ARCH)


OBJS = binio.o v5d.o

# The following are dependencies generated by running makedepend:

all : libv5d.a

libv5d.a : $(DIR_OBJ)/.dummy $(OBJS)
	cd $(DIR_OBJ) ; $(AR) crv $@ $(OBJS)

binio.o: binio.c binio.h
	$(CC) -c $(CFLAGS) $< -o $(DIR_OBJ)/$@
v5d.o: v5d.c binio.h v5d.h vis5d.h
	$(CC) -c $(CFLAGS) $< -o $(DIR_OBJ)/$@

$(DIR_OBJ)/.dummy :
	mkdir -p $(DIR_OBJ)
	@touch $(DIR_OBJ)/.dummy
tar :
	tar cvf vis5d.tar Makefile Rules* binio.c binio.h v5d.c v5d.h vis5d.h
clean :
	(if [ -d $(DIR_OBJ) ] ; then cd $(DIR_OBJ) ; rm -f $(OBJS); fi)

distclean:
	rm -rf $(DIR_OBJ)
